<?xml version="1.0" encoding="UTF-8"?>
<included>
	<appender name="LOKI_APPENDER" class="com.github.loki4j.logback.Loki4jAppender">
		<batchMaxItems>1000</batchMaxItems>
		<batchTimeoutMs>60000</batchTimeoutMs>
		<batchMaxBytes>4194304</batchMaxBytes>
		<verbose>true</verbose>
		<metricsEnabled>true</metricsEnabled>
		<drainOnStop>true</drainOnStop>
		<useDirectBuffers>true</useDirectBuffers>
		<sendQueueMaxBytes>41943040</sendQueueMaxBytes>
		<http class="com.github.loki4j.logback.ApacheHttpSender">
			<url>http://localhost:3100/loki/api/v1/push</url>
			<auth>
				<username>example_username</username>
				<password>example_api_token</password>
			</auth>
			<maxConnections>10</maxConnections>
			<connectionTimeoutMs>30000</connectionTimeoutMs>
			<requestTimeoutMs>15000</requestTimeoutMs>
			<connectionKeepAliveMs>120000</connectionKeepAliveMs>
		</http>
		<format class="com.github.loki4j.logback.JsonEncoder">
			<label>
				<pattern>app=my-app,host=${HOSTNAME},level=%level</pattern>
				<keyValueSeparator>=</keyValueSeparator>
				<pairSeparator>,</pairSeparator>
				<nopex>true</nopex>
			</label>
			<message>
				<!--<pattern>l=%level h=${HOSTNAME} c=%logger{20} t=%thread | %msg %ex</pattern>-->
				<pattern>${CONSOLE_LOG_PATTERN_NO_COLOR}</pattern>
			</message>
			<staticLabels>true</staticLabels>
			<sortByTime>true</sortByTime>
		</format>
	</appender>

	<appender name="LOKI_ASYNC_APPENDER" class="ch.qos.logback.classic.AsyncAppender">
		<queueSize>500</queueSize>
		<neverBlock>true</neverBlock>
		<discardingThreshold>0</discardingThreshold>
		<includeCallerData>true</includeCallerData>

		<appender-ref ref="LOKI_APPENDER"/>
	</appender>

</included>
