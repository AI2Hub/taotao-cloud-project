//https://nightlies.apache.org/flink/flink-docs-release-1.18/docs/dev/configuration/overview/
dependencies {
    implementation 'org.apache.flink:flink-core:1.15.0'
    implementation 'org.apache.flink:flink-streaming-java:1.15.0'
    implementation 'org.apache.flink:flink-shaded-guava:30.1.1-jre-15.0'
    implementation 'com.googlecode.aviator:aviator:5.3.1'

    testImplementation 'org.slf4j:slf4j-api:2.0.0'
    testImplementation 'mysql:mysql-connector-java:8.0.28'
    testImplementation 'org.apache.flink:flink-connector-kafka:${flink.version}'
    testImplementation 'org.apache.kafka:kafka-clients:2.4.1'
    testImplementation 'commons-cli:commons-cli:1.5.0'
}

configurations {
    all {
        resolutionStrategy.cacheChangingModulesFor 0, "seconds"
        resolutionStrategy.cacheDynamicVersionsFor 0, "seconds"

        resolutionStrategy {
            force 'org.glassfish:javax.el:3.0.0'
        }
    }
}

tasks.withType(ScalaCompile) {
    scalaCompileOptions.additionalParameters = ['-unchecked', '-deprecation']
}

jar {
    //详细信息参考 https://docs.gradle.org/current/dsl/org.gradle.api.tasks.bundling.Jar.html
    //archivesBaseName = 'Example'//基本的文件名
    //文件夹大于65535个，需要开启zip64
    //zip64=true

    manifest {
        attributes 'Main-Class': "com.taotao.cloud.bigdata.flink.JStreamWordCount"
    }
    //from sourceSets.main.output
    //dependsOn configurations.runtimeClasspath

    //gradle 处理重复文件，include 最后一个重复文件“胜出”的默认策略。
    //duplicatesStrategy = 'include' // <<---- addition
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE

    //打包依赖包
    //from {
    //    (configurations.runtimeClasspath).collect {
    //        it.isDirectory() ? it : zipTree(it)
    //    }
    //}
    //into('lib') { // 将第三方jar放入 lib目录中
    //    from configurations.compile
    //}
}


